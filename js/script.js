function createPath(e){pathValue[pathValueI]={};var t=cursorPoint(e);pathValue[pathValueI].x=t.x;pathValue[pathValueI].y=t.y;pathValueI++;if(!startCircle){startCircle=paper.circle(t.x,t.y,10);startCircle.attr({fill:"black"}).click(finishPath);return true}if(!path){path=paper.path()}d="M"+pathValue[0].x+" "+pathValue[0].y;for(var n=1,r=pathValue.length;n<r;n++){d+=" L"+pathValue[n].x+" "+pathValue[n].y}d+=" Z";path.attr({path:d})}function finishPath(){d="M"+pathValue[0].x+" "+pathValue[0].y;for(var e=1,t=pathValue.length;e<t;e++){d+=" L"+pathValue[e].x+" "+pathValue[e].y}d+=" L"+pathValue[0].x+" "+pathValue[0].y;d+=" Z";startCircle.remove();startCircle=null;pathValue=null;pathValue=new Array;pathValueI=0;currentResource.path=paper.path(d);currentResource.curve=null;currentResource.textNode=null;paper.myCreateTextNode({data:"Hello\nWorld",textPath:"M,10,80,C,10,80,290,80,300,80",path:"M446,74L446,74L551,89L559,176L487,277L398,277L365,167L378,86L446,74L450,75"},"");path.remove();path=null;drawBox.unclick().remove();drawBox=null}function svgToJSON(e){$(e).children("*").each(function(e,t){elementToJSON(t)})}function elementToJSON(e){var t={};if(e.tagName=="defs"||e.tagName=="style")return;svgToJSON(e)}function StringToXML(e){if(window.ActiveXObject){var t=new ActiveXObject("Microsoft.XMLDOM");t.loadXML(e);return t}else{return(new DOMParser).parseFromString(e,"text/xml")}}function addText(){$("#editText").show();$("#message").show()}function myKeyboard(e){var t=$("#input").val();paper.myCreateTextNode({data:t,textPath:"M,10,80,C,10,80,290,80,300,80",path:$(currentResource.path.node).attr("d")},"");dragStops()}function removeTextNode(){dragStarts();currentResource.freeTransform.unplug();for(var e=0,t=currentResource.textNode.length;e<t;e++){if(currentResource.textNode[e]){currentResource.textNode[e].remove()}}currentResource.textNode.clear();if(currentResource.rect){currentResource.rect.remove();currentResource.rect=null}}function welding(){$("#weldLoader").show();var e=this;setTimeout(function(){testPath=[];if(Clipper)delete Clipper;Clipper=new ClipperLib.Clipper;if(e.checked){$(".cutoutDiv").hide();$(".cutoutDivWeld").html("");$(".cutoutDivWeld").show();paper=Raphael($(".cutoutDivWeld")[0],0,0,500,350);$(".cutoutDivWeld svg").attr({height:500,width:350});$(".cutoutDivWeld svg").prepend(defs);paper.setViewBox(viewBox[0],viewBox[1],viewBox[2],viewBox[3]);$(".cutoutDiv svg").children("*").each(function(e,t){if(t.nodeName=="path"){testPath[testPath.length]=$(t).attr("d")}});paper.clear();Paper=paper;ResultPoly=new ClipperLib.Polygons;if(testPath.length>10){testPath[0]=myPathToPoly(testPath[0]);testPath[0]=scaleup(testPath[0],100);Clipper.AddPolygons(testPath[0],1);testPath[1]=myPathToPoly(testPath[1]);testPath[1]=scaleup(testPath[1],100);Clipper.AddPolygons(testPath[1],1);Clipper.Execute(1,ResultPoly,1,1);var t=null;for(var n=2,r=testPath.length;n<r;n++){Clipper=new ClipperLib.Clipper;testPath[n]=myPathToPoly(testPath[n]);testPath[n]=scaleup(testPath[n],100);Clipper.AddPolygons(testPath[n],Math.max(n,1));Clipper.AddPolygons(ResultPoly,Math.max(n,1));if(!Clipper.Execute(1,ResultPoly,1,1)){ResultPoly=t;break}t=ResultPoly.slice(0)}}else{for(var n=0,r=testPath.length;n<r;n++){testPath[n]=myPathToPoly(testPath[n]);testPath[n]=scaleup(testPath[n],100);Clipper.AddPolygons(testPath[n],Math.max(n,1))}Clipper.Execute(1,ResultPoly,1,1)}ResultPoly=polys2path(ResultPoly,100);var i=Paper.path(ResultPoly);i.attr({"stroke-width":"2"})}else{$(".cutoutDiv").show();$(".cutoutDivWeld").hide()}$("#weldLoader").hide()},500)}function resetWelding(){$("#weldingCheck").removeAttr("checked");$(".cutoutDiv").show();$(".cutoutDivWeld").hide();Paper.clear()}function totalPoints(e){var t=0;for(var n=0,r=e.length;n<r;n++){t+=e[n].length}}function cursorPoint(e){var t=paper.canvas;var n=t.createSVGPoint();n.x=e.pageX;n.y=e.pageY;return n.matrixTransform(t.getScreenCTM().inverse())}var startPath={};var startCircle,startDummyCircle;var xmlns="http://www.w3.org/2000/svg";var pathValue=new Array;var pathValueI=0;var path=null;var d="";var text=null;var textId=0;var paper;var fileContent;var GlobalElementTesting=null;var viewBox=null;var rect2=null;var TextJSON=[{param_id:"1",cust_id:"1",svg_url:"assets/svg with text2.svg",transformation:{0:{fontFamily:"MyriadProRegular",fontSize:18,color:"blue",curverPath:"M,10,80,C,10,80,290,80,300,80",lineSpacing:17,bleedingBoxPath:"M485,45L485,45L341,205L616,197L485,45L486,41"},1:{fontFamily:"BaroqueScript",fontSize:18,color:"red",curverPath:"M,10,80,C,10,80,290,80,300,80",lineSpacing:10,bleedingBoxPath:"M285,119L285,119L222,229L409,209L285,119L285,119",x:-91.71002187741288,y:-5.466374884579864,scale:{x:.3273131143950967,y:.7031532224056938},rotate:-8.057206634194902},2:{color:"#333333",font:"10px Arial",fontFamily:"'Arial'",fontSize:"90px",fontWeight:"bold",stroke:"none",strokeWidth:"0",style:"-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-style: normal; font-variant: normal; font-weight: bold; font-size: 90px; line-height: normal; font-family: Arial;",text:"Test Text",textAnchor:"start",thickness:"0",x:"47.908",y:"172.08",scale:{x:.3273131143950967,y:.7031532224056938},rotate:-8.057206634194902,curverPath:"M50,100c40,-50 270,50 300,0"}}}];var myPath=[];var myText=[];var svgJSON=[];$(".select_svg").change(function(){$("#loader").css("display","block");GlobalResource=[];currentResource=null;svgUrl=[];$(".exportBtn").show();svgJson=[];defs=[];svgAttr=[];SvgData={thickness:{zero:[],one:[]}};$("#svgContainer").html("");paper=Raphael("svgContainer",500,550);var e=paper.set();paper.customAttributes.textId=0;paper.customAttributes.textArray=[];fetch=this.value;setTimeout(function(){var e="assets/"+fetch+".svg";svgUrl.push(fetch);if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest}else{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}xmlhttp.open("GET",fetch,false);xmlhttp.send(null);fileContent=xmlhttp.responseXML;fileText=xmlhttp.responseText;svgXML=fileContent;svg=svgXML;fileText=fileText.substr(fileText.indexOf("<svg"),fileText.length);svg=StringToXML(fileText);paper.importSVG(svg,fileText);$("#loader").hide();viewBox=$(svgXML).children("svg").attr("viewBox");if(viewBox){viewBox=viewBox.split(" ");paper.setViewBox(viewBox[0],viewBox[1],viewBox[2],viewBox[3],true)}$("#tools").show();$("#editText").hide();var t=0;$("#svgContainer svg").find("*").each(function(e,n){t=$(n).attr("stroke");if(t!="none"&&t){$("#svgContainer svg").prepend(n)}})},100)});$("#addText").click(addText);$("#button").click(function(){$("#editText").hide()});$("#input").keyup(myKeyboard);(function(e){$.fn.attr=function(){if(arguments.length===0){if(this.length===0){return null}var t={};$.each(this[0].attributes,function(){if(this.specified){t[this.name]=this.value}});return t}return e.apply(this,arguments)}})($.fn.attr);var firstPath=null,secondPath=null;var comboPath=null,comboD=null;var testPath=new Array;var interD=null,differD;$("#blackout").click(resetWelding);$(".close").click(resetWelding);$("#weldingCheck").click(welding);$(document).ready(function(){});$("#font_family").change(function(){removeTextNode();paper.myCreateTextNode({data:"Hello\nWorld",textPath:"M,10,80,C,10,80,290,80,300,80",path:"M446,74L446,74L551,89L559,176L487,277L398,277L365,167L378,86L446,74L450,75",fontFamily:this.value},"")})

